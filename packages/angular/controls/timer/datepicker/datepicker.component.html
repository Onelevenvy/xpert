<label class="p-1 text-sm text-ellipsis whitespace-nowrap overflow-hidden disabled:opacity-50">
  {{ 'Ngm.DatePicker.Date' | translate: {Default: 'Date'} }}
</label>

@switch (selectionType) {
  @case (FilterType.SingleRange) {
    <div class="flex items-center">
    @switch (granularity()) {
      @case (TimeGranularity.Year) {
        <ngm-yearpicker class="flex flex-1 mr-2" [formControl]="fromDateControl"
          [label]="'Ngm.DatePicker.From' | translate: {Default: 'From'}"/>

        <ngm-yearpicker class="flex flex-1" [formControl]="dateControl" [label]="'Ngm.DatePicker.To' | translate: {Default: 'To'}">
          <button ngmSuffix mat-icon-button [cdkMenuTriggerFor]="granularityMenu"
            (click)="$event.stopPropagation();$event.preventDefault();">
            <mat-icon>more_vert</mat-icon>
          </button>
        </ngm-yearpicker>
      }
      @case (TimeGranularity.Quarter) {
        <ngm-quarterpicker class="flex flex-1 mr-2" [formControl]="fromDateControl"
          [label]="'Ngm.DatePicker.From' | translate: {Default: 'From'}" />

        <ngm-quarterpicker class="flex flex-1" [formControl]="dateControl" [label]="'Ngm.DatePicker.To' | translate: {Default: 'To'}">
          <button ngmSuffix mat-icon-button [cdkMenuTriggerFor]="granularityMenu"
            (click)="$event.stopPropagation();$event.preventDefault();">
              <mat-icon>more_vert</mat-icon>
          </button>
        </ngm-quarterpicker>
      }
      @case (TimeGranularity.Month) {
        <ngm-monthpicker class="flex flex-1 mr-2" [formControl]="fromDateControl"
          [label]="'Ngm.DatePicker.From' | translate: {Default: 'From'}" />

        <ngm-monthpicker class="flex flex-1" [formControl]="dateControl" [label]="'Ngm.DatePicker.To' | translate: {Default: 'To'}">
          <button ngmSuffix mat-icon-button [cdkMenuTriggerFor]="granularityMenu"
            (click)="$event.stopPropagation();$event.preventDefault();">
              <mat-icon>more_vert</mat-icon>
          </button>
        </ngm-monthpicker>
      }
      @default {
        <ngm-datepicker class="flex flex-1 mr-2" [formControl]="fromDateControl"
          [label]="'Ngm.DatePicker.From' | translate: {Default: 'From'}" />

        <ngm-datepicker class="flex flex-1" [formControl]="dateControl" [label]="'Ngm.DatePicker.To' | translate: {Default: 'To'}">
          <button ngmSuffix mat-icon-button [cdkMenuTriggerFor]="granularityMenu"
            (click)="$event.stopPropagation();$event.preventDefault();">
            <mat-icon>more_vert</mat-icon>
          </button>
        </ngm-datepicker>
      }
    }
    </div>
  }
  @default {
    @switch (granularity()) {
      @case (TimeGranularity.Year) {
        <ngm-yearpicker [formControl]="dateControl">
          <button ngmSuffix mat-icon-button displayDensity="compact" [cdkMenuTriggerFor]="granularityMenu"
            (click)="$event.stopPropagation();$event.preventDefault();">
              <mat-icon>more_vert</mat-icon>
          </button>
        </ngm-yearpicker>
      }
      @case (TimeGranularity.Quarter) {
        <ngm-quarterpicker [formControl]="dateControl">
          <button ngmSuffix mat-icon-button displayDensity="compact" [cdkMenuTriggerFor]="granularityMenu"
            (click)="$event.stopPropagation();$event.preventDefault();">
              <mat-icon>more_vert</mat-icon>
          </button>
        </ngm-quarterpicker>
      }
      @case (TimeGranularity.Month) {
        <ngm-monthpicker [formControl]="dateControl">
          <button ngmSuffix mat-icon-button displayDensity="compact" [cdkMenuTriggerFor]="granularityMenu"
            (click)="$event.stopPropagation();$event.preventDefault();">
              <mat-icon>more_vert</mat-icon>
          </button>
        </ngm-monthpicker>
      }
      @default {
        <ngm-datepicker [formControl]="dateControl">
          <button ngmSuffix mat-icon-button displayDensity="compact" [cdkMenuTriggerFor]="granularityMenu"
            (click)="$event.stopPropagation();$event.preventDefault();">
              <mat-icon>more_vert</mat-icon>
          </button>
        </ngm-datepicker>
      }
    }
  }
}

<ng-template #granularityMenu>
  <div cdkMenu class="cdk-menu__large ngm-density__compact">
    <mat-radio-group [(ngModel)]="granularity" class="flex flex-col">
      @for (value of TIME_GRANULARITY_SEQUENCES[granularitySequence ?? 2]; track value) {
        <mat-radio-button [value]="value">
          {{ 'Ngm.DatePicker.' + value | translate: {Default: value} }}
        </mat-radio-button>
      }
    </mat-radio-group>
  </div>
</ng-template>
