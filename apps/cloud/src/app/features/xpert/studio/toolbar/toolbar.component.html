<div class="flex items-center p-1 cursor-pointer text-sm font-medium rounded-lg shadow-lg border-[0.5px]
      bg-components-card-bg border-components-panel-border text-token-text-secondary"
   [cdkMenuTriggerFor]="zoomMenu"
  >
    <div
      class="flex items-center justify-center w-8 h-8 rounded-lg cursor-pointer active:scale-95 transition-transform hover:bg-black/5"
      [matTooltip]="'缩小'"
      (click)="$event.stopPropagation(); onZoomOut()"
      >
      <svg
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="currentColor"
        class="w-6 h-6"
      >
        <path
          d="M18.031 16.6168L22.3137 20.8995L20.8995 22.3137L16.6168 18.031C15.0769 19.263 13.124 20 11 20C6.032 20 2 15.968 2 11C2 6.032 6.032 2 11 2C15.968 2 20 6.032 20 11C20 13.124 19.263 15.0769 18.031 16.6168ZM16.0247 15.8748C17.2475 14.6146 18 12.8956 18 11C18 7.1325 14.8675 4 11 4C7.1325 4 4 7.1325 4 11C4 14.8675 7.1325 18 11 18C12.8956 18 14.6146 17.2475 15.8748 16.0247L16.0247 15.8748ZM7 10H15V12H7V10Z"
        ></path>
      </svg>
    </div>
    <div class="w-[34px] text-center">{{ fZoomScale }}%</div>
    <div
      class="flex items-center justify-center w-8 h-8 rounded-lg cursor-pointer active:scale-95 transition-transform hover:bg-black/5"
      [matTooltip]="'放大'"
      (click)="$event.stopPropagation(); onZoomIn()"
    >
    <svg
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="currentColor"
        class="w-6 h-6"
    >
        <path
        d="M18.031 16.6168L22.3137 20.8995L20.8995 22.3137L16.6168 18.031C15.0769 19.263 13.124 20 11 20C6.032 20 2 15.968 2 11C2 6.032 6.032 2 11 2C15.968 2 20 6.032 20 11C20 13.124 19.263 15.0769 18.031 16.6168ZM16.0247 15.8748C17.2475 14.6146 18 12.8956 18 11C18 7.1325 14.8675 4 11 4C7.1325 4 4 7.1325 4 11C4 14.8675 7.1325 18 11 18C12.8956 18 14.6146 17.2475 15.8748 16.0247L16.0247 15.8748ZM10 10V7H12V10H15V12H12V15H10V12H7V10H10Z"
        ></path>
    </svg>
    </div>
</div>

<div class="flex items-center gap-1 p-1 rounded-lg border-[0.5px] shadow-lg
  bg-components-card-bg border-components-panel-border text-token-text-secondary">
  <div
    [matTooltip]="'撤销'"
    class="flex items-center px-1.5 w-8 h-8 rounded-md text-sm font-medium hover:bg-black/5 hover:text-gray-700 cursor-pointer select-none false"
  >
    <svg
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    fill="currentColor"
    class="w-6 h-6"
    >
    <path
        d="M5.82843 6.99955L8.36396 9.53509L6.94975 10.9493L2 5.99955L6.94975 1.0498L8.36396 2.46402L5.82843 4.99955H13C17.4183 4.99955 21 8.58127 21 12.9996C21 17.4178 17.4183 20.9996 13 20.9996H4V18.9996H13C16.3137 18.9996 19 16.3133 19 12.9996C19 9.68584 16.3137 6.99955 13 6.99955H5.82843Z"
    ></path>
    </svg>
  </div>
  <div
    [matTooltip]="'重做'"
    class="flex items-center px-1.5 w-8 h-8 rounded-md text-sm font-medium hover:bg-black/5 hover:text-gray-700 cursor-pointer select-none opacity-50"
  >
    <svg
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    fill="currentColor"
    class="w-6 h-6"
    >
    <path
        d="M16 7H11C7.68629 7 5 9.68629 5 13C5 16.3137 7.68629 19 11 19H20V21H11C6.58172 21 3 17.4183 3 13C3 8.58172 6.58172 5 11 5H16V1L22 6L16 11V7Z"
    ></path>
    </svg>
  </div>
  <div class="mx-[3px] w-[1px] h-3.5 bg-gray-200"></div>
  <div class="inline-block">
    <div class="flex items-center justify-center w-8 h-8 rounded-md hover:bg-black/5 cursor-pointer"
      [matTooltip]="'变更历史'"
      [cdkMenuTriggerFor]="historyMenu">
      <svg
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="currentColor"
        class="w-6 h-6"
      >
        <path
        d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12H4C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C9.25022 4 6.82447 5.38734 5.38451 7.50024L8 7.5V9.5H2V3.5H4L3.99989 5.99918C5.82434 3.57075 8.72873 2 12 2ZM13 7L12.9998 11.585L16.2426 14.8284L14.8284 16.2426L10.9998 12.413L11 7H13Z"
        ></path>
      </svg>
    </div>
  </div>
</div>

<div class="flex items-center gap-1 p-1 rounded-lg border-[0.5px] shadow-lg
  bg-components-card-bg border-components-panel-border text-token-text-secondary">
  <div>
    <div
      class="flex items-center justify-center w-8 h-8 rounded-lg hover:bg-black/5 hover:text-gray-700 cursor-pointer false"
      >
      <svg
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="currentColor"
          class="w-6 h-6"
      >
          <path
          d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM11 11H7V13H11V17H13V13H17V11H13V7H11V11Z"
          ></path>
      </svg>
      </div>
  </div>

  <div
    class="flex items-center justify-center ml-[1px] w-8 h-8 rounded-lg hover:bg-black/5 hover:text-gray-700 cursor-pointer false"
  >
    <svg
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    fill="currentColor"
    class="w-6 h-6"
    >
    <path
        d="M4 1V4H1V6H4V9H6V6H9V4H6V1H4ZM3 20.0066V11H5V19H13V14C13 13.45 13.45 13 14 13L19 12.999V5H11V3H20.0066C20.5552 3 21 3.45576 21 4.00247V15L15 20.996L4.00221 21C3.4487 21 3 20.5551 3 20.0066ZM18.171 14.999L15 15V18.169L18.171 14.999Z"
    ></path>
    </svg>
  </div>
  <div class="mx-[3px] w-[1px] h-3.5 bg-gray-200"></div>
  <div
    class="flex items-center justify-center mr-[1px] w-8 h-8 rounded-lg cursor-pointer hover:bg-black/5 hover:text-gray-700 false"
  >
    <svg
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="currentColor"
        class="w-6 h-6"
        >
        <path
            d="M15.3873 13.4975L17.9403 20.5117L13.2418 22.2218L10.6889 15.2076L6.79004 17.6529L8.4086 1.63318L19.9457 12.8646L15.3873 13.4975ZM15.3768 19.3163L12.6618 11.8568L15.6212 11.4459L9.98201 5.9561L9.19088 13.7863L11.7221 12.1988L14.4371 19.6583L15.3768 19.3163Z"
        ></path>
    </svg>
  </div>
  <div
    class="flex items-center justify-center w-8 h-8 rounded-lg cursor-pointer bg-primary-50 text-primary-600 false"
  >
    <svg
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="currentColor"
        class="w-6 h-6"
        >
        <path
            d="M12.5002 2C12.2241 2 12.0002 2.22386 12.0002 2.5V12H10.0002V4.5C10.0002 4.22386 9.77634 4 9.5002 4C9.22405 4 9.0002 4.22386 9.0002 4.5V14C8.64653 14 7.00024 14 7.00024 14C6.61911 12.3792 5.64236 11.4407 4.5954 11.3216C4.87926 12.0664 5.36117 13.2592 6.16634 15.0995C7.02511 17.0622 7.89128 18.5218 9.00374 19.4986C10.0783 20.442 11.4586 21 13.5002 21C16.5378 21 19.0002 18.5377 19.0002 15.5002V7C19.0002 6.72386 18.7763 6.5 18.5002 6.5C18.2241 6.5 18.0002 6.72386 18.0002 7V12H16.0002V4C16.0002 3.72386 15.7763 3.5 15.5002 3.5C15.2241 3.5 15.0002 3.72386 15.0002 4V12H13.0002V2.5C13.0002 2.22386 12.7763 2 12.5002 2ZM21.0002 15.5002C21.0002 19.6424 17.6423 23 13.5002 23C11.0417 23 9.17214 22.308 7.68416 21.0015C6.23411 19.7283 5.22528 17.9381 4.33405 15.9012C3.40393 13.7753 2.89004 12.4804 2.60991 11.7235C2.25318 10.7597 2.74616 9.41212 4.08583 9.31846C5.24076 9.23771 6.22061 9.61249 7.0002 10.2587V4.5C7.0002 3.11929 8.11949 2 9.5002 2C9.68522 2 9.86554 2.0201 10.0391 2.05823C10.2477 0.888227 11.2702 0 12.5002 0C13.5602 0 14.4661 0.659694 14.8298 1.59091C15.0431 1.53167 15.268 1.5 15.5002 1.5C16.8809 1.5 18.0002 2.61929 18.0002 4V4.55001C18.1618 4.51722 18.329 4.5 18.5002 4.5C19.8809 4.5 21.0002 5.61929 21.0002 7V15.5002Z"
        ></path>
    </svg>
  </div>
  <div class="mx-[3px] w-[1px] h-3.5 bg-gray-200"></div>
  <div class="flex items-center justify-center w-8 h-8 rounded-lg hover:bg-black/5 hover:text-gray-700 cursor-pointer
      active:scale-95 transition-transform"
    [matTooltip]="'整理节点'"
    (click)="autoLayout()"
  >
    <svg
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="currentColor"
        class="w-6 h-6"
        >
        <path
            d="M4 3C3.44772 3 3 3.44772 3 4V10C3 10.5523 3.44772 11 4 11H10C10.5523 11 11 10.5523 11 10V4C11 3.44772 10.5523 3 10 3H4ZM4 13C3.44772 13 3 13.4477 3 14V20C3 20.5523 3.44772 21 4 21H10C10.5523 21 11 20.5523 11 20V14C11 13.4477 10.5523 13 10 13H4ZM14 13C13.4477 13 13 13.4477 13 14V20C13 20.5523 13.4477 21 14 21H20C20.5523 21 21 20.5523 21 20V14C21 13.4477 20.5523 13 20 13H14ZM15 19V15H19V19H15ZM5 9V5H9V9H5ZM5 19V15H9V19H5ZM16 11V8H13V6H16V3H18V6H21V8H18V11H16Z"
        ></path>
    </svg>
  </div>
</div>

<ng-template #zoomMenu>
  <div class="ngm-cdk-menu" cdkMenu>
    @for (level of zoomScales; track level) {
      <button
        class="ngm-cdk-menu-item flex items-center justify-start px-3 h-8 rounded-lg hover:bg-gray-50 cursor-pointer text-sm text-gray-700"
        (click)="onZoomTo(level)"
      >
        {{level}}%
      </button>
    }
    <button
      class="ngm-cdk-menu-item flex items-center justify-between px-3 h-8 rounded-lg hover:bg-gray-50 cursor-pointer text-sm text-gray-700"
      (click)="onFitToScreen()"
    >
      自适应视图
      <div class="flex items-center gap-0.5 h-4 text-xs text-gray-400">
        <div class="capitalize">⌘</div>
        <div class="capitalize">1</div>
      </div>
    </button>
  </div>
</ng-template>


<ng-template #historyMenu>
  <div class="ngm-cdk-menu" cdkMenu>
    <div class="sticky top-0 bg-white flex items-center justify-between px-2 pt-1 text-base font-semibold">
      <div class="grow">变更历史</div>
      <div class="shrink-0 flex items-center justify-center w-6 h-6 cursor-pointer">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
          class="w-6 h-6">
          <path d="M11.9997 10.5865L16.9495 5.63672L18.3637 7.05093L13.4139 12.0007L18.3637 16.9504L16.9495 18.3646L11.9997 13.4149L7.04996 18.3646L5.63574 16.9504L10.5855 12.0007L5.63574 7.05093L7.04996 5.63672L11.9997 10.5865Z"></path>
        </svg>
      </div>
    </div>
    @for (item of histories(); track item) {
      <button
        class="ngm-cdk-menu-item flex mb-0.5 px-2 py-[7px] rounded-lg hover:bg-primary-50 cursor-pointer"
        [ngClass]="historyCursor===item.cursor ? 'bg-primary-50' : ''"
        (click)="onGoToHistory(item)"
      >
        {{item.reason}}
      </button>
    }

      <div class="h-[1px] bg-gray-100"></div>
      <button
        class="ngm-cdk-menu-item flex items-center justify-between px-3 h-8 rounded-lg hover:bg-gray-50 cursor-pointer text-sm text-gray-700"
        ngmAppearance="danger"
        (click)="clearHistory()"
      >
        清除历史记录
      </button>

      <div class="px-3 w-[240px] py-2 text-sm text-gray-500">
        <div class="flex items-center mb-1 h-[22px] font-medium uppercase">提示</div>
        <div class="mb-1 text-gray-700 leading-[18px]">您的编辑操作将被跟踪并存储在您的设备上，直到您离开编辑器。此历史记录将在您离开编辑器时被清除。</div>
      </div>
    </div>
</ng-template>
