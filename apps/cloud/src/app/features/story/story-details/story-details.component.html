<div class="nx-theme-dark w-[300px] shrink-0 flex flex-col justify-start overflow-auto bg-bluegray-700 text-white p-4 group">
  <div class="w-full flex justify-start items-center my-2" cdkDrag cdkDragRootElement=".cdk-overlay-pane" cdkDragHandle>
    <mat-icon displayDensity="cosy" class="-ml-2 opacity-0 group-hover:opacity-80">drag_indicator</mat-icon>
    <span class="text-lg pointer-events-none">
      {{ 'Story.StoryDetails.TITLE' | translate: {Default: "Story Details"} }}
    </span>
  </div>

  <input #fileUpload type="file" class="file-input h-0 invisible" (change)="onFileSelected($event)" (click)="fileUpload.value=null;" accept="image/*">
    
  <mat-nav-list class="ngm-nav-list">
    <mat-list-item class="mt-2" [class.active]="activeLink === c_details"
      (click)="activeLink = c_details">
      <span > {{ 'Story.StoryDetails.General' | translate: {Default: 'General'} }} </span>
    </mat-list-item>

    <mat-list-item class="mt-2" [class.active]="activeLink === c_thumbnail"
      (click)="activeLink = c_thumbnail">
      <span> {{ 'Story.StoryDetails.Thumbnail' | translate: {Default: 'Thumbnail'} }} </span>
    </mat-list-item>
  </mat-nav-list>

  <div class="flex-1">
    <div *ngIf="activeLink === c_thumbnail" class="flex-1 flex flex-col justify-start items-end gap-2 my-2">
      <button mat-stroked-button ngmAppearance="dashed" displayDensity="cosy" color="accent" (click)="fileUpload.click()">
        <div class="flex justify-start items-center">
          <mat-icon fontSet="material-icons-round">upload</mat-icon>
          {{ 'Story.Common.Upload' | translate: {Default: "Upload"} }}
        </div>
      </button>

      <mat-form-field appearance="fill" color="accent" class="w-full">
        <mat-label>
          {{ 'Story.StoryDetails.ThumbnailUrl' | translate: {Default: "Thumbnail Url"} }}
        </mat-label>
        <input matInput [(ngModel)]="thumbnail" (ngModelChange)="onThumbnailChange($event)">
      </mat-form-field>
    </div>
  </div>
  <div class="flex justify-between">
    <div ngmButtonGroup>
      <button mat-raised-button color="accent" cdkFocusInitial (click)="onApply()">
        {{ 'Story.Common.Apply' | translate: {Default: "Apply"} }}
      </button>
      <button mat-button (click)="reset()">
        {{ 'Story.Common.Reset' | translate: {Default: "Reset"} }}
      </button>
    </div>
  </div>
</div>

<div>
  <div *ngIf="activeLink === c_details" class="grid grid-cols-1 gap-x-4 sm:grid-cols-2 p-8">

    <mat-form-field appearance="fill" class="grid-cols-1 sm:col-span-2">
      <mat-label>
        {{ 'Story.StoryDetails.StoryName' | translate: {Default: "Story Name"} }}
      </mat-label>
      <input matInput [(ngModel)]="name">
    </mat-form-field>

    <mat-form-field appearance="fill" floatLabel="always" class="grid-cols-1 sm:col-span-2">
      <mat-label>
          {{ 'Story.StoryDetails.Description' | translate: { Default: 'Description' } }}
      </mat-label>
      <textarea matInput [(ngModel)]="description"
          placeholder="{{ 'Story.StoryDetails.DescriptionPlaceholder' | translate: { Default: 'Optional, desciption of the story' } }}"
      ></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill" floatLabel="always" class="col-span-2">
      <mat-label>
        {{ 'Story.StoryDetails.Models' | translate: { Default: 'Models' } }}
      </mat-label>
      <mat-chip-grid #chipGrid>
        <mat-chip-row *ngFor="let model of models()" color="primary" highlighted (removed)="removeModel(model)">
          {{model.name}}
          <button matChipRemove [attr.aria-label]="'remove ' + model.name">
            <mat-icon>cancel</mat-icon>
          </button>
        </mat-chip-row>
      </mat-chip-grid>
      <input type="text" #modelInput
             placeholder="{{ 'Story.StoryDetails.AddSemanticModels' | translate: { Default: 'Add semantic models' } }}"
             matInput
             [formControl]="modelCtrl"
             [matChipInputFor]="chipGrid"
             [matAutocomplete]="auto">
      <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete" [displayWith]="displayWithName"
        (optionSelected)="modelSelected($event)">
        <mat-option *ngFor="let option of models$()" [value]="option">
          <div class="flex items-center">
            <button mat-icon-button displayDensity="cosy" (click)="openSemanticModel(option.id)">
              <mat-icon>open_in_new</mat-icon>
            </button>
            <span [highlight]="highlight" [caseSensitive]="false" customClasses="bg-transparent font-semibold text-amber-500"
              [content]="option.name">
            </span>
          </div>
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <mat-form-field appearance="fill" class="col-span-1">
      <mat-label>
        {{ 'Story.StoryDetails.LOCALE' | translate: {Default: "Locale"} }}
      </mat-label>
      <mat-select [(value)]="details.locale">
        <!-- <mat-option value="en-US">
          {{ 'Story.StoryDetails.LOCALE_enUS' | translate: {Default: "en-US"} }}
        </mat-option> -->
        <mat-option value="en">
          {{ 'Story.StoryDetails.LOCALE_en' | translate: {Default: "en"} }}
        </mat-option>
        <mat-option value="zh-Hans">
          {{ 'Story.StoryDetails.LOCALE_zhHans' | translate: {Default: "zh-Hans"} }}
        </mat-option>
      </mat-select>
    </mat-form-field>
<!--   
    <mat-form-field appearance="fill" class="col-span-1">
      <mat-label>
        {{ 'Story.StoryDetails.THEME' | translate: {Default: "Theme"} }}
      </mat-label>
      <mat-select [(value)]="details.themeName">
        <mat-option value="system" >
          <div class="flex items-center">
            <svg viewBox="0 0 24 24" fill="none" class="w-6 h-6 mr-2"><path d="M4 6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Z" stroke-width="2" stroke-linejoin="round" class="stroke-slate-400 dark:stroke-slate-500"></path><path d="M14 15c0 3 2 5 2 5H8s2-2 2-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="stroke-slate-400 dark:stroke-slate-500"></path></svg>
            {{ 'Story.Common.Theme.System' | translate: {Default: "System"} }}
          </div>
        </mat-option>
        <mat-option value="light">
          <div class="flex items-center">
            <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 mr-2"><path d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" class="stroke-slate-400 dark:stroke-slate-500"></path><path d="M12 4v1M17.66 6.344l-.828.828M20.005 12.004h-1M17.66 17.664l-.828-.828M12 20.01V19M6.34 17.664l.835-.836M3.995 12.004h1.01M6 6l.835.836" class="stroke-slate-400 dark:stroke-slate-500"></path></svg>
            {{ 'Story.Common.Theme.Light' | translate: {Default: "Light"} }}
          </div>
        </mat-option>
        <mat-option value="dark">
          <div class="flex items-center">
            <svg viewBox="0 0 24 24" fill="none" class="w-6 h-6 mr-2">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M17.715 15.15A6.5 6.5 0 0 1 9 6.035C6.106 6.922 4 9.645 4 12.867c0 3.94 3.153 7.136 7.042 7.136 3.101 0 5.734-2.032 6.673-4.853Z" class="fill-transparent"></path>
              <path d="m17.715 15.15.95.316a1 1 0 0 0-1.445-1.185l.495.869ZM9 6.035l.846.534a1 1 0 0 0-1.14-1.49L9 6.035Zm8.221 8.246a5.47 5.47 0 0 1-2.72.718v2a7.47 7.47 0 0 0 3.71-.98l-.99-1.738Zm-2.72.718A5.5 5.5 0 0 1 9 9.5H7a7.5 7.5 0 0 0 7.5 7.5v-2ZM9 9.5c0-1.079.31-2.082.845-2.93L8.153 5.5A7.47 7.47 0 0 0 7 9.5h2Zm-4 3.368C5 10.089 6.815 7.75 9.292 6.99L8.706 5.08C5.397 6.094 3 9.201 3 12.867h2Zm6.042 6.136C7.718 19.003 5 16.268 5 12.867H3c0 4.48 3.588 8.136 8.042 8.136v-2Zm5.725-4.17c-.81 2.433-3.074 4.17-5.725 4.17v2c3.552 0 6.553-2.327 7.622-5.537l-1.897-.632Z" class="fill-slate-400 dark:fill-slate-500"></path>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M17 3a1 1 0 0 1 1 1 2 2 0 0 0 2 2 1 1 0 1 1 0 2 2 2 0 0 0-2 2 1 1 0 1 1-2 0 2 2 0 0 0-2-2 1 1 0 1 1 0-2 2 2 0 0 0 2-2 1 1 0 0 1 1-1Z" class="fill-slate-400 dark:fill-slate-500"></path>
            </svg>
            {{ 'Story.Common.Theme.Dark' | translate: {Default: "Dark"} }}
          </div>
        </mat-option>
        <mat-option value="thin">
          <div class="flex items-center">
            <svg viewBox="0 0 24 24" fill="none" class="w-6 h-6 mr-2">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M17.715 15.15A6.5 6.5 0 0 1 9 6.035C6.106 6.922 4 9.645 4 12.867c0 3.94 3.153 7.136 7.042 7.136 3.101 0 5.734-2.032 6.673-4.853Z" class="fill-transparent"></path>
              <path d="m17.715 15.15.95.316a1 1 0 0 0-1.445-1.185l.495.869ZM9 6.035l.846.534a1 1 0 0 0-1.14-1.49L9 6.035Zm8.221 8.246a5.47 5.47 0 0 1-2.72.718v2a7.47 7.47 0 0 0 3.71-.98l-.99-1.738Zm-2.72.718A5.5 5.5 0 0 1 9 9.5H7a7.5 7.5 0 0 0 7.5 7.5v-2ZM9 9.5c0-1.079.31-2.082.845-2.93L8.153 5.5A7.47 7.47 0 0 0 7 9.5h2Zm-4 3.368C5 10.089 6.815 7.75 9.292 6.99L8.706 5.08C5.397 6.094 3 9.201 3 12.867h2Zm6.042 6.136C7.718 19.003 5 16.268 5 12.867H3c0 4.48 3.588 8.136 8.042 8.136v-2Zm5.725-4.17c-.81 2.433-3.074 4.17-5.725 4.17v2c3.552 0 6.553-2.327 7.622-5.537l-1.897-.632Z" class="fill-slate-400 dark:fill-slate-500"></path>
            </svg>
            {{ 'Story.Common.Theme.Thin' | translate: {Default: "Thin"} }}
          </div>
        </mat-option>
      </mat-select>
    </mat-form-field> -->

    <mat-checkbox [(ngModel)]="details.fullscreen" class="col-span-1 my-2">
      {{ 'Story.StoryDetails.DISPLAY_AS_FULLSCREEN' | translate: {Default: "Display as Fullscreen"} }}
    </mat-checkbox>

    <!-- <mat-checkbox [(ngModel)]="details.showFullscreenButton" class="col-span-1 my-2">
      {{ 'Story.StoryDetails.SHOW_FULLSCREEN_BUTTON' | translate: {Default: "Show Fullscreen Button"} }}
    </mat-checkbox>

    <mat-checkbox [(ngModel)]="details.hideStoryFilterBar" class="col-span-1 my-2">
      {{ 'Story.StoryDetails.HIDE_STORY_FILTER_BAR' | translate: {Default: "Hide Story Filter Bar"} }}
    </mat-checkbox> -->
    
  </div>

  <div *ngIf="activeLink === c_thumbnail" class="min-h-[500px] min-w-[600px] relative">
    <img *ngIf="imagePreview" [src]="imagePreview" alt="Image Preview" class="object-contain mx-auto h-auto">

    <button mat-icon-button class="pac-story-details__thumbnail-remove absolute right-2 top-2" displayDensity="cosy" ngmAppearance="danger"
      (click)="deleteThumbnail()">
      <mat-icon>close</mat-icon>
    </button>
  </div>
</div>
