<div class="p-2 flex justify-between items-center bg-components-card-bg rounded-xl">
  <div class="text-lg font-semibold text-text-primary">
    {{ 'PAC.MODEL.CalculatedMembers' | translate: {Default: 'Calculated Members'} }}
  </div>

  <button class="btn pressable relative flex justify-center items-center w-7 h-7 rounded-lg border-0 text-text-secondary hover:text-text-primary
        bg-transparent hover:bg-hover-bg"
    [disabled]="!dirty() || saving()"
    (click)="save()">
    <i class="ri-save-line"></i>
    @if (dirty()) {
      <span class="absolute top-1 end-1 inline-flex items-center transform -translate-y-1/2 translate-x-1/2">
        @if (saving()) {
          <i class="ri-loader-line text-xs animate-spin"></i>
        } @else {
          <span class="w-3 h-3 rounded-full border-2 border-white text-xs font-medium bg-text-warning text-white dark:border-neutral-900">
            <span class="sr-only">Is dirty</span>
          </span>
        }
      </span>
    }
  </button>
</div>

<ul class="p-1 overflow-auto">
  @for (item of members(); track item.key) {
    <li (click)="onMemberClick(item)" class="group/item relative cursor-pointer hover:bg-hover-bg p-2 rounded-lg border-b border-solid border-divider-regular">
      <div class="text-base text-text-secondary">{{item.caption}} [{{item.name}}]</div>
      <div class="text-sm text-text-secondary line-clamp-2">{{item.description}}</div>
      <div class="text-sm text-text-secondary font-mono">{{item.formula}}</div>

      <button type="button" class="absolute right-1 top-1 w-7 h-7 flex justify-center items-center opacity-0 group-hover/item:opacity-100">
        <i class="ri-edit-line"></i>
      </button>
    </li>
  }
</ul>

@if (memberKey()) {
  <xp-model-member-edit @overlayAnimation1 class="absolute top-0 left-0 w-full h-full rounded-2xl bg-white hover:bg-neutral-100 border border-solid border-divider-regular shadow-sm"
    [(member)]="member"
    [modelKey]="modelKey()"
    [cubeName]="cubeName()"
    (close)="memberKey.set(null)"
  />
}